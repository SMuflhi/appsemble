/apps:
  post:
    tags: [app]
    description: Create a new app
    x-oai-middleware:
      - file: apps
        handler: create
    parameters:
      - name: app
        in: body
        description: The app to create.
        required: true
        schema:
          $ref: '#/definitions/App'
    responses:
      201:
        description: The app that was created.
        schema:
          $ref: '#/definitions/App'
      default:
        $ref: '#/responses/default'
    security:
      - oauthPassword:
          - apps:write
  get:
    tags: [app]
    description: Get all existing apps.
    x-oai-middleware:
      - file: apps
        handler: query
    responses:
      200:
        description: The list of all apps.
        schema:
          type: array
          items:
            $ref: '#/definitions/App'
      default:
        $ref: '#/responses/default'
    security:
      - oauthPassword:
          - apps:read

/apps/{id}:
  get:
    tags: [app]
    description: Get a single app
    x-oai-middleware:
      - file: apps
        handler: getOne
    parameters:
      - name: id
        in: path
        description: The id of the app to get.
        required: true
        type: integer
    responses:
      200:
        description: The app that matches the given id.
        schema:
          $ref: '#/definitions/App'
      default:
        $ref: '#/responses/default'
  put:
    tags: [app]
    description: Update an existing app
    x-oai-middleware:
      - file: apps
        handler: update
    parameters:
      - name: id
        in: path
        description: The id of the app to update.
        required: true
        type: integer
      - name: app
        in: body
        description: The new app configuration.
        required: true
        schema:
          $ref: '#/definitions/App'
    responses:
      200:
        description: The updated app.
        schema:
          $ref: '#/definitions/App'
      default:
        $ref: '#/responses/default'
    security:
      - oauthPassword:
          - apps:write

/apps/{id}/icon:
  post:
    tags: [app]
    description: |
      Change the app icon.

      If not icon has been specified, the Appsemble icon will be served.
    consumes:
      # These are the underlying formats that are supported by our underlying image processing library, sharp.
      # http://sharp.pixelplumbing.com/en/stable/#formats
      # image/gif has been excluded, because those tend to contain multiple frames.
      - image/jpeg
      - image/png
      - image/tiff
      - image/webp
      - image/xml+svg
    x-oai-middleware:
      - file: apps
        handler: setAppIcon
    parameters:
      - name: id
        in: path
        description: The id of the app whose icon to update.
        required: true
        type: integer
      - name: icon
        in: body
        description: The new app icon.
        required: true
        schema:
          type: object
    responses:
      204:
        description: The icon has been updated succesfully.
      default:
        $ref: '#/responses/default'
    security:
      - oauthPassword:
          - apps:write
  delete:
    tags: [app]
    description: |
      Delete the app icon from the database.

      When the app icon has been deleted, the Appsemble icon will be served.
    x-oai-middleware:
      - file: apps
        handler: deleteAppIcon
    parameters:
      - name: id
        in: path
        description: The id of the app whose icon to delete.
        required: true
        type: integer
    responses:
      204:
        description: The icon has been deleted succesfully.
      default:
        $ref: '#/responses/default'
    security:
      - oauthPassword:
          - apps:write
