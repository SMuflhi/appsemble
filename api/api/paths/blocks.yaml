/blocks:
  post:
    tags: [block]
    description: Register a new block.
    x-oai-middleware:
      - file: blocks
        handler: createBlockDefinition
    parameters:
      - name: block
        in: body
        description: The block definition to create.
        required: true
        schema:
          $ref: '#/definitions/BlockDefinition'
    responses:
      201:
        description: The block definition that was created.
        schema:
          $ref: '#/definitions/BlockDefinition'
      default:
        $ref: '#/responses/default'
  get:
    tags: [block]
    description: Get all existing block definitions.
    x-oai-middleware:
      - file: blocks
        handler: queryBlockDefinitions
    responses:
      200:
        description: The list of all block definitions.
        schema:
          type: array
          items:
            $ref: '#/definitions/BlockDefinition'
      default:
        $ref: '#/responses/default'

/blocks/{organization}/{id}:
  get:
    tags: [block]
    description: Get a single block
    x-oai-middleware:
      - file: blocks
        handler: getBlockDefinition
    parameters:
      - name: organization
        in: path
        description: The organization of the block definition to get.
        required: true
        type: string
      - name: id
        in: path
        description: The id of the block definition to get.
        required: true
        type: string
    responses:
      200:
        description: The app that matches the given id.
        schema:
          $ref: '#/definitions/BlockDefinition'
      default:
        $ref: '#/responses/default'

/blocks/{organization}/{id}/versions:
  post:
    tags: [block version]
    description: Publish a version of a block definition
    operationId: createBlockVersion
    consumes:
      - multipart/form-data
    x-oai-middleware:
      - file: blocks
        handler: createBlockVersion
    parameters:
      - name: organization
        in: path
        description: The organization of the block definition.
        required: true
        type: string
      - name: id
        in: path
        description: The id of the block definition.
        required: true
        type: string
      - name: version
        in: formData
        type: string
        description: The block version description in a JSON format.
      # OpenAPI 2.0 doesnâ€™t support repeated form data parameters. This will look significantly
      # more clean after updating to OpenAPI 3.0
      - name: files
        in: formData
        type: file
    responses:
      200:
        description: The app that matches the given id.
        schema:
          $ref: '#/definitions/BlockVersion'
      default:
        $ref: '#/responses/default'

/blocks/{organization}/{id}/versions/{version}/{path}:
  get:
    tags: [block version]
    description: Get an asset of a block version.
    # operationId: getBlockAsset
    x-oai-middleware:
      - file: blocks
        handler: getBlockAsset
    parameters:
      - name: organization
        in: path
        description: The organization of the block definition.
        required: true
        type: string
      - name: id
        in: path
        description: The id of the block definition.
        required: true
        type: string
      - name: version
        in: path
        type: string
        required: true
        description: The block version description in a JSON format.
      - name: path
        in: path
        description: The path segments of the asset to get.
        required: true
        type: string
    responses:
      200:
        description: The Block asset.
      default:
        $ref: '#/responses/default'
